package Dao;

import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import DomainObject.Customer;
import JDBC.jdbc;

public class CustomerDao implements InterfaceCustomer{
	private final String insert ="insert into Customer (CustomerName) value (?)";
	private final String  update= "update Customer set CustomerName = ? Where CustomerId = ?";
	private final String delete = "delete from Customer Where CustomerId= ?";
	private final String selectAll= "select *from Customer";
	private final String selectById ="select *form Customer where CustomerId=?";
	@Override
	public void insert(Customer c) {
		jdbc.update(insert, c.getCustomerName());
		
	}

	@Override
	public void update(Customer c) {
		jdbc.update(update, c.getCustomerName());
		
	}

	@Override
	public void delete(Customer id) {
		// TODO Auto-generated method stub
		jdbc.update(delete, id);
		
	}

	@Override
	public List<Customer> selectAll() {
		
		return selectBySQL(selectAll);
	}

	@Override
	public Customer selectId(String id) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<Customer> selectBySQL(String sql, Object... args) {
		List<Customer> lst = new ArrayList<>();
		try {
			ResultSet rs = jdbc.query(sql, args);
			while(rs.next()) {
				Customer c = new Customer();
				c.setCustomerName(rs.getString("CustomerName"));
				lst.add(c);
			}
			rs.getStatement().getConnection().close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return lst;
	}
	 

}

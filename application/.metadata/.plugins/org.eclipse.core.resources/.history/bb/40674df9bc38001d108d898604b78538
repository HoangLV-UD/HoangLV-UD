package JDBC;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import javax.management.RuntimeErrorException;

public class jdbc {
	static String driver = "com.microsoft.sqlserver.jdbc.SQLServerDriver";
	static String dbUrl = "jdbc:sqlserver://:1433;databaseName=app";
	static String user = "sa";
	static String pass ="123456";
	
	static {
		try {
			Class.forName(driver);
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}
	public static PreparedStatement getStmt(String sql, Object...args)throws Exception{
	
			Connection conn = DriverManager.getConnection(dbUrl, user,pass);
			PreparedStatement stmt = null;
			if(sql.trim().startsWith("{")) {
				stmt = conn.prepareCall(sql); 
			}else {
				stmt = conn.prepareStatement(sql); 
			}
			for (int i=0; i <args.length; i++) {
				stmt.setObject(i +1, args[1]);
			}
		
		return stmt;
				
	}
	public static ResultSet query(String sql, Object... args) throws Exception {
        PreparedStatement stmt = jdbc.getStmt(sql, args);
        return stmt.executeQuery();
    }
	
	public static PreparedStatement preparedStatement(String sql,Object...args)throws SQLException{
		Connection connection = DriverManager.getConnection(dbUrl,user,pass);
		PreparedStatement statment = null;
		if(sql.trim().startsWith("{")) {
			statment = connection.prepareCall(sql);
		}else {
			statment =connection.prepareStatement(sql);
		}
		for(int i =0; i < args.length; i++) {
			statment.setObject(i + 1, args[i]);
		}
		return statment;
		
	}
}	
